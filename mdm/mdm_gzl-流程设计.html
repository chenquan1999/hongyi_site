<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>流程设计页面</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="./font-awesome.min.css" rel="stylesheet">
  
  <!-- Tailwind配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#165DFF',
            success: '#00B42A',
            warning: '#FF7D00',
            danger: '#F53F3F',
            neutral: {
              100: '#F2F3F5',
              200: '#E5E6EB',
              300: '#C9CDD4',
              400: '#86909C',
              500: '#4E5969',
              600: '#272E3B',
              700: '#1D2129',
            }
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <!-- 自定义工具类 -->
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .shadow-node {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      }
      .node-transition {
        transition: all 0.2s ease;
      }
      .canvas-bg {
        background-image: linear-gradient(#f2f3f5 1px, transparent 1px),
                          linear-gradient(90deg, #f2f3f5 1px, transparent 1px);
        background-size: 20px 20px;
      }
    }
  </style>
  
  <style>
    /* 连接线样式 */
    .connection {
      stroke: #c9cdd4;
      stroke-width: 2;
      fill: none;
    }
    
    .connection-arrow {
      fill: #c9cdd4;
    }
    
    /* 节点样式 */
    .process-node {
      position: absolute;
      padding: 8px 12px;
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: move;
      transition: all 0.2s ease;
      user-select: none;
    }
    
    .process-node:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }
    
    .process-node-start {
      background-color: #e8f3ff;
      border: 1px solid #165DFF;
      color: #165DFF;
    }
    
    .process-node-task {
      background-color: #f2f3f5;
      border: 1px solid #c9cdd4;
      color: #4e5969;
    }
    
    .process-node-end {
      background-color: #f0fff4;
      border: 1px solid #00b42a;
      color: #00b42a;
    }
    
    /* 配置面板标签样式 */
    .config-tab {
      border-bottom: 2px solid transparent;
      transition: all 0.2s ease;
    }
    
    .config-tab.active {
      border-bottom-color: #165DFF;
      color: #165DFF;
      font-weight: 500;
    }
    
    /* 滚动条样式 */
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #c9cdd4;
      border-radius: 3px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #86909c;
    }
  </style>
</head>
<body class="bg-neutral-100 font-inter text-neutral-700 min-h-screen flex flex-col">
  <!-- 顶部导航栏 -->
  <header class="bg-white shadow-sm z-10">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center space-x-4">
        <a href="#" class="text-primary font-semibold text-lg flex items-center">
          <i class="fa fa-sitemap mr-2"></i>
          <span>流程设计器</span>
        </a>
        <nav class="hidden md:flex items-center space-x-1">
          <a href="#" class="px-3 py-2 rounded-md text-sm font-medium text-neutral-500 hover:text-primary transition-colors">首页</a>
          <a href="#" class="px-3 py-2 rounded-md text-sm font-medium text-primary bg-blue-50 transition-colors">流程设计</a>
          <a href="#" class="px-3 py-2 rounded-md text-sm font-medium text-neutral-500 hover:text-primary transition-colors">流程管理</a>
          <a href="#" class="px-3 py-2 rounded-md text-sm font-medium text-neutral-500 hover:text-primary transition-colors">表单设计</a>
          <a href="#" class="px-3 py-2 rounded-md text-sm font-medium text-neutral-500 hover:text-primary transition-colors">数据模型</a>
        </nav>
      </div>
      <div class="flex items-center space-x-4">
        <button class="hidden md:flex items-center px-3 py-1.5 text-sm font-medium text-neutral-500 hover:text-primary transition-colors">
          <i class="fa fa-question-circle mr-1"></i>
          <span>帮助</span>
        </button>
        <div class="relative">
          <button class="flex items-center space-x-2 px-3 py-1.5 rounded-full bg-neutral-100 hover:bg-neutral-200 transition-colors">
            <img src="https://picsum.photos/id/1005/200/200" alt="用户头像" class="w-6 h-6 rounded-full object-cover">
            <span class="hidden md:inline-block text-sm font-medium">管理员</span>
            <i class="fa fa-angle-down text-neutral-400"></i>
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- 主内容区 -->
  <main class="flex-1 flex overflow-hidden">
    <!-- 左侧工具栏 -->
    <aside class="w-16 bg-white border-r border-neutral-200 flex flex-col items-center py-4 space-y-4">
      <button class="w-10 h-10 rounded-lg flex items-center justify-center text-neutral-500 hover:bg-blue-50 hover:text-primary transition-colors">
        <i class="fa fa-mouse-pointer"></i>
      </button>
      <button class="w-10 h-10 rounded-lg flex items-center justify-center text-neutral-500 hover:bg-blue-50 hover:text-primary transition-colors">
        <i class="fa fa-object-group"></i>
      </button>
      <button class="w-10 h-10 rounded-lg flex items-center justify-center text-neutral-500 hover:bg-blue-50 hover:text-primary transition-colors">
        <i class="fa fa-arrows-h"></i>
      </button>
      <button class="w-10 h-10 rounded-lg flex items-center justify-center text-neutral-500 hover:bg-blue-50 hover:text-primary transition-colors">
        <i class="fa fa-plus-square"></i>
      </button>
      <button class="w-10 h-10 rounded-lg flex items-center justify-center text-neutral-500 hover:bg-blue-50 hover:text-primary transition-colors">
        <i class="fa fa-trash-o"></i>
      </button>
      <button class="w-10 h-10 rounded-lg flex items-center justify-center text-neutral-500 hover:bg-blue-50 hover:text-primary transition-colors">
        <i class="fa fa-arrows"></i>
      </button>
      <div class="flex-1"></div>
      <button class="w-10 h-10 rounded-lg flex items-center justify-center text-neutral-500 hover:bg-blue-50 hover:text-primary transition-colors">
        <i class="fa fa-expand"></i>
      </button>
      <button class="w-10 h-10 rounded-lg flex items-center justify-center text-neutral-500 hover:bg-blue-50 hover:text-primary transition-colors">
        <i class="fa fa-compress"></i>
      </button>
    </aside>

    <!-- 中间画布区域 -->
    <div class="flex-1 relative overflow-hidden bg-white canvas-bg" style="min-height: calc(100vh - 56px);">
      <!-- 画布操作工具栏 -->
      <div class="absolute top-3 right-3 flex space-x-2 z-10">
        <button class="px-3 py-1.5 bg-white shadow-sm rounded-md text-sm text-neutral-500 hover:text-primary hover:shadow transition-colors flex items-center">
          <i class="fa fa-search-plus mr-1"></i>
          <span>放大</span>
        </button>
        <button class="px-3 py-1.5 bg-white shadow-sm rounded-md text-sm text-neutral-500 hover:text-primary hover:shadow transition-colors flex items-center">
          <i class="fa fa-search-minus mr-1"></i>
          <span>缩小</span>
        </button>
        <button class="px-3 py-1.5 bg-white shadow-sm rounded-md text-sm text-neutral-500 hover:text-primary hover:shadow transition-colors flex items-center">
          <i class="fa fa-expand mr-1"></i>
          <span>适应窗口</span>
        </button>
      </div>
      
      <!-- 流程图节点容器 -->
      <div class="absolute inset-0" style="transform-origin: 0 0;">
        <!-- SVG 连接线容器 -->
        <svg class="absolute inset-0 w-full h-full pointer-events-none" id="connection-svg">
          <!-- 连接线将通过JS动态生成 -->
          <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" class="connection-arrow" />
            </marker>
          </defs>
        </svg>
        
        <!-- 流程节点 -->
        <div class="process-node process-node-start" id="node-start" style="left: 60px; top: 120px;">
          <span class="font-medium">开始</span>
        </div>
        
        <div class="process-node process-node-task" id="node-business" style="left: 220px; top: 120px;">
          <span class="font-medium">业务审批</span>
        </div>
        
        <div class="process-node process-node-task" id="node-data" style="left: 380px; top: 120px;">
          <span class="font-medium">数据审批</span>
        </div>
        
        <div class="process-node process-node-task" id="node-publish" style="left: 540px; top: 120px;">
          <span class="font-medium">发布审批</span>
        </div>
        
        <div class="process-node process-node-end" id="node-end" style="left: 700px; top: 120px;">
          <span class="font-medium">结束</span>
        </div>
      </div>
    </div>

    <!-- 右侧配置面板 -->
    <aside class="w-80 bg-white border-l border-neutral-200 overflow-y-auto">
      <div class="p-4">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-semibold text-neutral-700">节点配置</h3>
          <button class="text-neutral-400 hover:text-neutral-600 transition-colors">
            <i class="fa fa-times"></i>
          </button>
        </div>
        
        <!-- 标签页 -->
        <div class="flex border-b border-neutral-200 mb-4">
          <button class="config-tab active px-4 py-2 text-sm" data-tab="general">常规配置</button>
          <button class="config-tab px-4 py-2 text-sm text-neutral-500" data-tab="task">任务配置</button>
          <button class="config-tab px-4 py-2 text-sm text-neutral-500" data-tab="listener">监听配置</button>
          <button class="config-tab px-4 py-2 text-sm text-neutral-500" data-tab="other">其它配置</button>
        </div>
        
        <!-- 配置内容区域 -->
        <div class="space-y-4">
          <!-- 常规配置 -->
          <div class="tab-content" id="tab-general">
            <div class="space-y-3">
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">节点名称</label>
                <input type="text" value="业务审批" class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">节点类型</label>
                <select class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
                  <option>用户任务</option>
                  <option>服务任务</option>
                  <option>并行网关</option>
                  <option>排他网关</option>
                  <option>事件网关</option>
                </select>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">任务表单</label>
                <div class="flex items-center space-x-2">
                  <select class="flex-1 px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
                    <option>审核测试页面c1</option>
                    <option>业务申请表单</option>
                    <option>数据审核表单</option>
                  </select>
                  <button class="px-3 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors text-sm flex items-center">
                    <i class="fa fa-key mr-1"></i>
                    <span>表单授权</span>
                  </button>
                </div>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">多实例</label>
                <div class="flex items-center justify-between">
                  <span class="text-sm text-neutral-600">无</span>
                  <button class="px-3 py-1.5 bg-white border border-neutral-300 rounded-md hover:bg-neutral-50 transition-colors text-sm flex items-center">
                    <i class="fa fa-eye mr-1"></i>
                    <span>查看</span>
                  </button>
                </div>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">实例类型</label>
                <select class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
                  <option>无</option>
                  <option>顺序多实例</option>
                  <option>并行多实例</option>
                </select>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">扩展属性</label>
                <textarea rows="3" class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm" placeholder="请输入扩展属性..."></textarea>
              </div>
            </div>
          </div>
          
          <!-- 任务配置 -->
          <div class="tab-content hidden" id="tab-task">
            <div class="space-y-3">
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">任务分配</label>
                <div class="flex items-center space-x-2">
                  <select class="flex-1 px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
                    <option>用户</option>
                    <option>角色</option>
                    <option>部门</option>
                    <option>表达式</option>
                  </select>
                  <button class="px-3 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors text-sm">
                    <i class="fa fa-plus"></i>
                  </button>
                </div>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">处理人</label>
                <div class="bg-neutral-50 p-3 rounded-md">
                  <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-medium">张三</span>
                    <button class="text-neutral-400 hover:text-neutral-600">
                      <i class="fa fa-times"></i>
                    </button>
                  </div>
                  <div class="flex items-center justify-between">
                    <span class="text-sm font-medium">李四</span>
                    <button class="text-neutral-400 hover:text-neutral-600">
                      <i class="fa fa-times"></i>
                    </button>
                  </div>
                </div>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">任务监听器</label>
                <div class="flex items-center justify-between">
                  <span class="text-sm text-neutral-600">无</span>
                  <button class="px-3 py-1.5 bg-white border border-neutral-300 rounded-md hover:bg-neutral-50 transition-colors text-sm">
                    <i class="fa fa-plus mr-1"></i>
                    <span>添加</span>
                  </button>
                </div>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">任务候选人</label>
                <input type="text" placeholder="输入候选人名称..." class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
              </div>
            </div>
          </div>
          
          <!-- 监听配置 -->
          <div class="tab-content hidden" id="tab-listener">
            <div class="space-y-3">
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">执行监听器</label>
                <div class="flex items-center justify-between">
                  <span class="text-sm text-neutral-600">无</span>
                  <button class="px-3 py-1.5 bg-white border border-neutral-300 rounded-md hover:bg-neutral-50 transition-colors text-sm">
                    <i class="fa fa-plus mr-1"></i>
                    <span>添加</span>
                  </button>
                </div>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">事件类型</label>
                <select class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
                  <option>start</option>
                  <option>end</option>
                  <option>take</option>
                </select>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">实现类</label>
                <input type="text" placeholder="输入实现类..." class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">表达式</label>
                <input type="text" placeholder="输入表达式..." class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
              </div>
            </div>
          </div>
          
          <!-- 其它配置 -->
          <div class="tab-content hidden" id="tab-other">
            <div class="space-y-3">
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">节点描述</label>
                <textarea rows="3" class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm" placeholder="请输入节点描述..."></textarea>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">节点超时设置</label>
                <div class="flex items-center space-x-2">
                  <input type="number" value="24" class="w-20 px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
                  <span class="text-sm text-neutral-500">小时</span>
                </div>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">节点优先级</label>
                <select class="w-full px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
                  <option>低</option>
                  <option selected>中</option>
                  <option>高</option>
                </select>
              </div>
              
              <div>
                <label class="block text-sm font-medium text-neutral-500 mb-1">自定义属性</label>
                <div class="flex items-center space-x-2 mb-2">
                  <input type="text" placeholder="属性名" class="flex-1 px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
                  <input type="text" placeholder="属性值" class="flex-1 px-3 py-2 border border-neutral-300 rounded-md focus:ring-2 focus:ring-primary/30 focus:border-primary outline-none transition-colors text-sm">
                  <button class="px-3 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors text-sm">
                    <i class="fa fa-plus"></i>
                  </button>
                </div>
                <div class="bg-neutral-50 p-3 rounded-md">
                  <div class="flex items-center justify-between mb-2">
                    <div class="flex space-x-4">
                      <span class="text-sm font-medium">优先级</span>
                      <span class="text-sm text-neutral-600">高</span>
                    </div>
                    <button class="text-neutral-400 hover:text-neutral-600">
                      <i class="fa fa-times"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 底部操作按钮 -->
        <div class="mt-6 pt-4 border-t border-neutral-200 flex justify-end space-x-2">
          <button class="px-4 py-2 border border-neutral-300 rounded-md text-sm font-medium text-neutral-700 hover:bg-neutral-50 transition-colors">
            取消
          </button>
          <button class="px-4 py-2 bg-warning text-white rounded-md text-sm font-medium hover:bg-warning/90 transition-colors">
            <i class="fa fa-refresh mr-1"></i>
            重新绘制
          </button>
          <button class="px-4 py-2 bg-primary text-white rounded-md text-sm font-medium hover:bg-primary/90 transition-colors">
            <i class="fa fa-save mr-1"></i>
            保存模型
          </button>
        </div>
      </div>
    </aside>
  </main>

  <!-- 页脚 -->
  <footer class="bg-white border-t border-neutral-200 py-3">
    <div class="container mx-auto px-4 text-center text-sm text-neutral-500">
      <p>© 2023 流程设计器 - 版本 1.0.0</p>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // 初始化页面
    document.addEventListener('DOMContentLoaded', function() {
      // 绘制节点间连接线
      drawConnections();
      
      // 配置面板标签切换
      setupConfigTabs();
      
      // 为节点添加悬停效果
      setupNodeHoverEffects();
    });
    
    // 绘制节点间连接线
    function drawConnections() {
      const svg = document.getElementById('connection-svg');
      
      // 节点ID映射，用于连接节点
      const nodeIds = [
        { id: 'node-start', next: 'node-business' },
        { id: 'node-business', next: 'node-data' },
        { id: 'node-data', next: 'node-publish' },
        { id: 'node-publish', next: 'node-end' }
      ];
      
      // 绘制连接线
      nodeIds.forEach(item => {
        const startNode = document.getElementById(item.id);
        const endNode = document.getElementById(item.next);
        
        if (startNode && endNode) {
          // 获取节点位置和尺寸
          const startRect = startNode.getBoundingClientRect();
          const endRect = endNode.getBoundingClientRect();
          const svgRect = svg.getBoundingClientRect();
          
          // 计算连接线的起点和终点（相对于SVG）
          const startX = startRect.right - svgRect.left;
          const startY = startRect.top + startRect.height / 2 - svgRect.top;
          const endX = endRect.left - svgRect.left;
          const endY = endRect.top + endRect.height / 2 - svgRect.top;
          
          // 创建连接线
          const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
          const midX = startX + (endX - startX) / 2;
          
          // 使用贝塞尔曲线创建平滑连接线
          path.setAttribute('d', `M ${startX} ${startY} C ${midX} ${startY}, ${midX} ${endY}, ${endX} ${endY}`);
          path.setAttribute('class', 'connection');
          path.setAttribute('marker-end', 'url(#arrowhead)');
          
          // 添加连接线到SVG
          svg.appendChild(path);
        }
      });
    }
    
    // 配置面板标签切换
    function setupConfigTabs() {
      const tabs = document.querySelectorAll('.config-tab');
      const tabContents = document.querySelectorAll('.tab-content');
      
      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          // 移除所有标签的活动状态
          tabs.forEach(t => t.classList.remove('active'));
          
          // 添加当前标签的活动状态
          tab.classList.add('active');
          
          // 隐藏所有内容
          tabContents.forEach(content => content.classList.add('hidden'));
          
          // 显示当前标签对应的内容
          const tabId = tab.getAttribute('data-tab');
          document.getElementById(`tab-${tabId}`).classList.remove('hidden');
        });
      });
    }
    
    // 为节点添加悬停效果
    function setupNodeHoverEffects() {
      const nodes = document.querySelectorAll('.process-node');
      
      nodes.forEach(node => {
        node.addEventListener('mouseenter', () => {
          node.classList.add('shadow-lg');
          node.classList.add('scale-105');
        });
        
        node.addEventListener('mouseleave', () => {
          node.classList.remove('shadow-lg');
          node.classList.remove('scale-105');
        });
      });
    }
  </script>
</body>
</html>
